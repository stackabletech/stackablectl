# ---
# apiVersion: v1
# kind: ConfigMap
# metadata:
#   name: opagroups
#   labels:
#     opa.stackable.tech/bundle: "true"
# data:
#   data.json: |
#     {
#       "admins": [
#         "57d3b407-ecc0-4cc1-aaaf-45a63f43b96b",
#         "170b4130-ca4d-417b-b229-f2917d5ab3d1"
#       ],
#       "nonadmins": [
#         "62f04ea3-5485-4d47-86c0-fde821842dc8"
#       ]
#     }
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: opa-bundle-trino
  labels:
    opa.stackable.tech/bundle: "true"
data:
  trino.rego: |
    package trino
    import data.bundles.opagroups.admins
    import future.keywords.in

    default allow = true

    allow {
      input.context.identity.user in admins
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: opa-bundle-druid
  labels:
    opa.stackable.tech/bundle: "true"
data:
  druid.rego: |
    package druid
    import data.bundles.opagroups.admins
    import future.keywords.in
    import future.keywords.if

    default allow = false

    allow if input.user in admins

    allow if input.user == "druid_system"
